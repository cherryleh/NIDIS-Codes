<html>
    <head>
        <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    </head>
    <body>
        <script>
            const CSV = "ndvi_df.csv"
  
            function plotFromCSV() {
                Plotly.d3.csv(CSV, function(err, rows) {
                    console.log(rows);
                    processData(rows);
                });
            }
  
            function processData(allRows) {
                let x = [];
                let y1 = [];
                let row;
                let i = 0;
                while (i < allRows.length) {
                    row = allRows[i];
                    x.push(row["datetime"]);
                    y1.push(row["NDVI"]);
                    i += 1;
                }
            
                console.log("X", x);
                console.log("Y1", y1);
                makePlotly(x, y1,);
            }
  
            var selectorOptions = {
                buttons: [{
                    step: 'month',
                    stepmode: 'backward',
                    count: 1,
                    label: '1m'
                }, {
                    step: 'month',
                    stepmode: 'backward',
                    count: 6,
                    label: '6m'
                }, {
                    step: 'year',
                    stepmode: 'todate',
                    count: 1,
                    label: 'YTD'
                }, {
                    step: 'year',
                    stepmode: 'backward',
                    count: 1,
                    label: '1y'
                }, {
                    step: 'all',
                }],
            };
  
            function makePlotly(x, y1) {
                let traces = [
                    {
                        x: x,
                        y: y1,
                        name: "NDVI",
                        hovertemplate: 'NDVI: %{y}<extra></extra>',
                        line: {
                            color: "#387fba",
                            width: 3
                        }
                        
                    }
                ];
                let layout = {
                    yaxis: {
                        range: [0.2, 0.8]
                    },
                    xaxis: {
                        rangeselector: selectorOptions,
                        rangeslider: {}
                    },
                };
                let config = { 
                    responsive: true,
                    displayModeBar: true,
                };
  
                
  
                Plotly.newPlot("ndvi", traces, layout, config);
            }
            plotFromCSV();
  
  
        </script>
        <div class="history" style="width: 100%">
            <div id="ndvi" >
            </div>
        </div>
    </body>
</html>